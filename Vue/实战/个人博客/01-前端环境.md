



# 个人博客



## 前端环境

1. 安装node 和 npm

2. 安装yarn

   ```liunx
   npm install -g yarn
   ```

3. 安装vue脚手架工具

   ```
   yarn global add @vue/cli
   ```

4. 创建vue项目

   ```
   vue create blog
   ```

5. 启动项目

   ```
   yarn serve
   ```

## 主页面

1. 创建文件../src/views/IndexView.vue并编辑以下内容

   ```vue
   <template>
   </template>
   
   <script>
   export default {
     components: {
     }
   
   }
   </script>
   
   <style scoped>
   
   </style>
   ```



## 导航组件

1. 依赖安装

   ```
   cd blog
   yarn add bootstrap
   yarn add @popperjs/core
   ```

   

2. 在components目录下创建文件WideNavbar.vue并编辑以下内容

   ```vue
   <template>
     <div class="wrapper">
       <div class="container d-flex justify-content-center">
         <div class="title">
           Welcome, Perter!
           <div class="title-info">
             A Modern Blog with Markdown, developed by XXX
             <div class="d-flex justify-content-sm-center">
               <router-link :to="{name: 'user_login'}">
                 <button type="button" class="btn btn-lg btn-outline-primary mt-5 me-5">登录</button>
               </router-link>
               <router-link :to="{name: 'user_register'}">
                 <button type="button" class="btn btn-lg btn-outline-primary mt-5 me-5">注册</button>
               </router-link>
             </div>
           </div
         </div>
       </div>
     </div>
   </template>
   
   <script setup>
   
   </script>
   
   
   <style scoped>
   .wrapper {
     background-image: linear-gradient(-225deg, #231557 0%, #44107A 29%, #FF1361 67%, #FFF800 100%);
   }
   .title {
     margin-top: 40px;
     text-align: center;
     font-size: 5vh;
     color: white;
   }
   .title-info {
     padding: 3vh;
     text-align: center;
     font-size: 3vh;
   }
   .btn-outline-primary {
     background-color: transparent;
     border-color: white;
     color: white;
   }
   .btn-outline-primary:hover {
     border-color: whitesmoke;
     transition-duration: 200ms;
   }
   </style>
   ```

3. 将组件挂载到主页面中

   ```vue
   <template>
     <WideNavbar></WideNavbar>
   </template>
   
   <script>
   import WideNavbar from "../components/WideNavbar";
   export default {
     components: {
       WideNavbar,
     }
   
   }
   </script>
   
   <style scoped>
   
   </style>
   ```

   

## markdow组件

1. 依赖安装

   ```liunx
   cd blog
   yarn add md-editor-v3
   yarn add @vavt/cm-extension
   yarn add @vavt/v3-extension
   yarn add --dev @babel/plugin-transform-private-methods
   ```

2. babel.config.js文件配置

   ```javascript
   module.exports = {
     presets: [
       '@vue/cli-plugin-babel/preset'
     ],
     plugins: [
       "@babel/plugin-transform-private-methods"
     ]
   }
   ```

3. 在components目录下创建文件WideNavbar.vue并编辑以下内容

   ```vue
   <template>
     <MdEditor v-model="text" />
   </template>
   
   <script setup>
   import { ref } from 'vue';
   import { MdEditor } from 'md-editor-v3';
   import 'md-editor-v3/lib/style.css';
   
   const text = ref('# Hello Editor');
   </script>
   
   <style scoped>
   
   </style>
   ```

4. 将组件挂载到主页面中

   ```vue
   <template>
     <WideNavbar></WideNavbar>
     <MdEditor></MdEditor>
   </template>
   
   <script>
   import MdEditor from "../components/MdEditor";
   import WideNavbar from "../components/WideNavbar";
   export default {
     components: {
       MdEditor,
       WideNavbar,
     }
   
   }
   </script>
   
   <style scoped>
   
   </style>
   ```



## 路由配置

1. 下载vue-router@4

   ```
   yarn add vue-router@4
   ```

2. 新建路由文件..src/router/index.js并编辑内容

   ```javascript
   import {createRouter, createWebHistory} from "vue-router";
   import IndexView from "../views/IndexView";
   
   const routes = [
       {
           path: "/",
           name: "index",
           component: IndexView
       }
   ]
   
   const router = createRouter({
       history: createWebHistory(),
       routes,
   })
   
   export default router
   ```

3. 编辑main.js文件，使用路由模式访问页面

   ```Javascript
   import { createApp } from 'vue'
   import App from './App.vue'
   import router from "@/router";
   createApp(App).use(router).mount('#app')
   ```

4. 将<router-view>挂载到App.vue,即可通过路由访问页面组件

   ```vue
   <template>
     <router-view></router-view>
   </template>
   <script>
   import "bootstrap/dist/css/bootstrap.css";
   import "bootstrap/dist/js/bootstrap.min.js";
   export default {
     name: 'App',
     components: {
     }
   }
   </script>
   
   <style scoped>
   </style>
   ```

5. 通过http://localhost:8080/ 即可访问主页

## 登录页面

1. 创建文件../src/views/user/account/LoginView.vue并编辑以下内容

   ```vue
   <template>
     <section class="vh-100">
       <div class="d-flex align-items-center h-100 gradient-1">
         <div class="container h-100" >
           <div class="row d-flex justify-content-center align-items-center h-100">
             <div class="col-12 clo-md-9 col-lg-7 col-xl-4">
               <div class="card" style="border-radius: 15px;">
                 <div class="card-body p-5">
                   <h2 class="text-center mb-5">登录</h2>
                   <form>
                     <div class="form-outline mb-4">
                       <input type="text" id="username" class="form-control form-control-lg">
                       <label class="form-label" for="username">用户名</label>
                     </div>
                     <div class="form-outline mb-4">
                       <input type="password" id="password" class="form-control form-control-lg">
                       <label class="form-label" for="password">密码</label>
                     </div>
                     <div class="d-flex justify-content-center">
                       <button type="submit" class="btn btn-success btn-block btn-lg gradient-2">
                         登录
                       </button>
                     </div>
                     <div class="error_message">错误信息</div>
                     <p class="text-center text-muted mt-3">还没有账号?
                       <router-link :to="{name:'user_register'}" class="fw-bold text-body">
                         <u>去注册</u>
                       </router-link>
                     </p>
                   </form>
                 </div>
               </div>
             </div>
           </div>
         </div>
       </div>
     </section>
   </template>
   <script>
   
   
   </script>
   <style scoped>
   .error_message {
     color: red;
   }
   .gradient-1 {
     background-image: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);;
   }
   .gradient-2 {
     background-image: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);;
   }
   </style>
   ```

2. 在路由文件..src/router/index.js中编辑内容

   ```javascript
   import {createRouter, createWebHistory} from "vue-router";
   import LoginView from "../views/user/account/LoginView";
   
   const routes = [
     ...
       {
           path: "/user/account/login/",
           name: "user_login",
           component: LoginView
       }
     ...
   ]
   
   const router = createRouter({
       history: createWebHistory(),
       routes,
   })
   
   export default router
   ```

3. 使用<router-link>元素将组件挂到登录按钮上，点击按钮可以跳转登录页面

   ```vue
   <router-link :to="{name: 'user_login'}">
   	<button type="button" class="btn btn-lg btn-outline-primary mt-5 me-5">登录</button>
   </router-link>
   ```

## 注册页面

1. 创建文件../src/views/user/account/RegisterView.vue并编辑以下内容

   ```vue
   <template>
     <section class="vh-100">
       <div class="d-flex align-items-center h-100 gradient-1">
         <div class="container h-100" >
           <div class="row d-flex justify-content-center align-items-center h-100">
             <div class="col-12 clo-md-9 col-lg-7 col-xl-4">
               <div class="card" style="border-radius: 15px;">
                 <div class="card-body p-5">
                   <h2 class="text-center mb-5">注册</h2>
                   <form>
                     <div class="form-outline mb-4">
                       <input type="text" v-model="username" id="username" class="form-control form-control-lg">
                       <label class="form-label" for="username">用户名</label>
                     </div>
                     <div class="form-outline mb-4">
                       <input type="password" v-model="password" id="password" class="form-control form-control-lg">
                       <label class="form-label" for="password">密码</label>
                     </div>
                     <div class="form-outline mb-4">
                       <input type="password" v-model="password_confirm" id="password_confirm" class="form-control form-control-lg">
                       <label class="form-label" for="password_confirm">确认密码</label>
                     </div>
                     <div class="d-flex justify-content-center">
                       <button type="submit" class="btn btn-success btn-block btn-lg gradient-2">
                         注册
                       </button>
                     </div>
                     <div class="error_message">{{ error_message }}</div>
                     <p class="text-center text-muted mt-3">已有账号?
                       <router-link :to="{name:'user_login'}" class="fw-bold text-body">
                         <u>去登录</u>
                       </router-link>
                     </p>
                   </form>
                 </div>
               </div>
             </div>
           </div>
         </div>
       </div>
     </section>
   </template>
   <script>
   
   
   </script>
   <style scoped>
   .error_message {
     color: red;
   }
   .gradient-1 {
     background-image: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);;
   }
   .gradient-2 {
     background-image: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);;
   }
   </style>
   ```

2. 在路由文件..src/router/index.js中编辑内容

   ```javascript
   import {createRouter, createWebHistory} from "vue-router";
   import RegisterView from "../views/user/account/RegisterView";
   
   const routes = [
     ...
       {
           path: "/user/account/register/",
           name: "user_register",
           component: RegisterView
       },
     ...
   ]
   
   const router = createRouter({
       history: createWebHistory(),
       routes,
   })
   
   export default router
   ```

3. 使用<router-link>元素将组件挂到登录按钮上，点击按钮可以跳转注册页面

   ```vue
   <router-link :to="{name: 'user_register'}">
   	<button type="button" class="btn btn-lg btn-outline-primary mt-5 me-5">注册</button>
   </router-link>
   ```

## 注册功能（向后端发起注册请求）

1. 下载jquery

   ```liunx
   yarn add jquery
   ```

2. 修改RegisterView.vue的<form>元素，将点击按钮事件与注册函数绑定

   ```vue
   <form @submit.prevent="register">
   ...
   </form>
   
   ```

3. 存在注册接口http://127.0.0.1:8000/user/register/，在RegisterView.vue的<script>标签内编写以下js代码，定义register函数

   ```vue
   <script>
   import {ref} from "vue";
   import $ from "jquery";
   import router from "@/router";
   export default {
     setup() {
       let username = ref("");
       let password = ref("");
       let password_confirm = ref("");
       let error_message = ref("");
   
       const register = () => {
         // 发起请求
         $.ajax({
           url: "http://127.0.0.1:8000/user/register/",
           type: "POST",
           data: {
             "username": username.value,
             "password": password.value,
             "password_confirm": password_confirm.value,
           },
           // 请求后处理
           success(resp) {
             if (resp.message === 'success') {
               console.log(resp)
               // 登录成功，跳转主页面
               router.push({name:'index'})
             } else {
               // 请求message不为success，将错误显示出来
               error_message.value = resp.message
             }
           },
           error(resp) {
             console.log(resp);
           }
         })
       }
   
       return {
         username,
         password,
         password_confirm,
         error_message,
         register,
       }
     }
   
   }
   </script>
   ```



## 解决跨域问题（django）

1. 以django为例下载django_cors_headers

   ```liunx
   pip install django_cors_headers
   ```

2. 配置项目settings.py文件

   ```python
   # 将包添加到APP
   INSTALLED_APPS = [
     ...
       'corsheaders',
   	...
   ]
   
   # 配置中间件，并将django.middleware.csrf.CsrfViewMiddleware注释掉
   MIDDLEWARE = [
     ...
       'corsheaders.middleware.CorsMiddleware',
       # 'django.middleware.csrf.CsrfViewMiddleware',
     ...
   ]
   
   # 配置允许跨域地址（前端服务的地址）
   CORS_ALLOWED_ORIGINS = ['http://localhost:8080']
   # 配置允许所有请求
   CORS_ALLOWED_HEADERS = ('*')
   
   ```

   



